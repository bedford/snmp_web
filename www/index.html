<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>登录页</title>
	<link rel="stylesheet" href="css/jquery-ui.min.css">
<style>
html {
    width: 100%;
    height: 100%;
    overflow: hidden;
    font-style: sans-serif;
}

body {
    width: 100%;
    height: 100%;
    font-family: 'Open Sans', sans-serif;
    margin: 0;
    background-color: #4A374A;
}

#login {
    position: absolute;
    top: 50%;
    left:50%;
    margin: -150px 0 0 -150px;
    width: 300px;
    height: 300px;
}

#login h1 {
    color: #fff;
    text-shadow:0 0 10px;
    letter-spacing: 1px;
    text-align: center;
}

h1 {
    font-size: 2em;
    margin: 0.67em 0;
}

input {
    width: 278px;
    height: 18px;
    margin-bottom: 10px;
    outline: none;
    padding: 10px;
    font-size: 13px;
    color: #fff;
    text-shadow:1px 1px 1px;
    border-top: 1px solid #312E3D;
    border-left: 1px solid #312E3D;
    border-right: 1px solid #312E3D;
    border-bottom: 1px solid #56536A;
    border-radius: 4px;
    background-color: #2D2D3F;
}

.but {
    width: 300px;
    min-height: 40px;
    display: block;
    background-color: #4a77d4;
    border: 1px solid #3762bc;
    color: #fff;
    padding: 9px 14px;
    font-size: 15px;
    line-height: normal;
    border-radius: 5px;
    margin: 0;
}
</style>
</head>

<body>
    <div id="login">
        <h1>SNMP网页客户端</h1>
        <form id="login_form">
            <input type="text" required="required" placeholder="用户名" id="user">
            <input type="password" required="required" placeholder="密码" id="password">
			<input type="button" class="but" id="login_btn" value="登录" onclick="login_snmp()">
        </form>
    </div>

	<div class="jq-dialog" id="hint_dialog" title="提示信息">
		<label id="hint_detail"></label>
	</div>

	<script src="js/jquery-1.12.0.js"></script>
	<script src="js/jquery-ui.min.js"></script>
	<script src="js/jquery.json-2.3.min.js"></script>
    <script>
		function login_snmp() {
			var user = $('#user').val();
        	var password = $('#password').val();
			if (user.length == 0) {
				var html = '用户名不能为空';
				$('#hint_detail').html(html);
				$('#hint_dialog').dialog({
					resizable: false,
					height: 160,
					modal: true,
					buttons: {
						"确定": function() {
							$(this).dialog("close");
						}
					}
				});
				return;
			}

			if (password.length == 0) {
				var html = '密码不能为空';
				$('#hint_detail').html(html);
				$('#hint_dialog').dialog({
					resizable: false,
					height: 160,
					modal: true,
					buttons: {
						"确定": function() {
							$(this).dialog("close");
						}
					}
				});
				return;	
			}

			var json = new Object();
			json.msg_type = "system_setting";
			json.cmd_type = "login";

			var cfg = new Object();
			cfg.user = user;
			cfg.password = password;
			json.cfg = cfg;

			$('#login_btn').attr("disabled", "disabled");
			var data = $.toJSON(json);
		    $.ajax({
		                url     : "/cgi-bin/common.cgi",
		                type    : "POST",
		                dataType: "json",
		                data    : data,
		                success : function(msg) {
		                    $('#login_btn').removeAttr("disabled");
							var html = '';
							if (msg.status == 1) {
								window.location.href = "/main.html";
								window.sessionStorage.setItem("user_information", user);
								window.sessionStorage.setItem("authority_information", msg.desc);
								window.sessionStorage.setItem("timeout", msg.exit);
							} else { 
								$('#hint_detail').html('密码错误');
								$('#hint_dialog').dialog({
									resizable: false,
									height: 160,
									modal: true,
									buttons: {
										"确定": function() {
											$(this).dialog("close");
										}
									}
								});
							}
		                },
						error : function(msg) {
		                    $('#login_btn').removeAttr("disabled");
							$('#hint_detail').html("连接服务器异常");
							$('#hint_dialog').dialog({
								resizable: false,
								height: 160,
								modal: true,
								buttons: {
									"确定": function() {
										$(this).dialog("close");
									}
								}
							});
						}
					});
		}
	</script>
</body>
</html>